<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- =====================================================
         WORKSPACE TYPES
    ====================================================== -->

    <record id="view_workspace_type_tree" model="ir.ui.view">
        <field name="name">workspace.type.tree</field>
        <field name="model">workspace.type</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="code"/>
                <field name="description"/>
            </tree>
        </field>
    </record>

    <record id="view_workspace_type_form" model="ir.ui.view">
        <field name="name">workspace.type.form</field>
        <field name="model">workspace.type</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="name"/>
                            <field name="code"/>
                        </group>
                    </group>
                    <group string="Description">
                        <field name="description" nolabel="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_workspace_type" model="ir.actions.act_window">
        <field name="name">Space Types</field>
        <field name="res_model">workspace.type</field>
        <field name="view_mode">tree,form</field>
    </record>


    <!-- =====================================================
         WORKSPACE AMENITIES
    ====================================================== -->

    <record id="view_workspace_amenity_tree" model="ir.ui.view">
        <field name="name">workspace.amenity.tree</field>
        <field name="model">workspace.amenity</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="icon"/>
            </tree>
        </field>
    </record>

    <record id="view_workspace_amenity_form" model="ir.ui.view">
        <field name="name">workspace.amenity.form</field>
        <field name="model">workspace.amenity</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="icon" placeholder="e.g. fa-wifi, fa-tv"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_workspace_amenity" model="ir.actions.act_window">
        <field name="name">Amenities</field>
        <field name="res_model">workspace.amenity</field>
        <field name="view_mode">tree,form</field>
    </record>


    <!-- =====================================================
         WORKSPACE SPACES
         - amenity_ids is Many2many to workspace.amenity
           via relation table workspace_space_amenity_rel
         - photos is Binary (single image)
    ====================================================== -->

    <record id="view_workspace_space_tree" model="ir.ui.view">
        <field name="name">workspace.space.tree</field>
        <field name="model">workspace.space</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="space_type_id"/>
                <field name="location_floor"/>
                <field name="location_zone"/>
                <field name="capacity"/>
                <field name="hourly_rate"/>
                <field name="daily_rate"/>
                <field name="monthly_rate"/>
                <field name="is_active"/>
            </tree>
        </field>
    </record>

    <record id="view_workspace_space_form" model="ir.ui.view">
        <field name="name">workspace.space.form</field>
        <field name="model">workspace.space</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <!-- Binary photo shown as avatar top-right -->
                    <field name="photos" widget="image" class="oe_avatar" nolabel="1"/>

                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Space Name"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Space Details">
                            <field name="space_type_id"/>
                            <field name="capacity"/>
                            <field name="is_active"/>
                        </group>
                        <group string="Location">
                            <field name="location_floor"/>
                            <field name="location_zone"/>
                        </group>
                    </group>

                    <group string="Pricing">
                        <group>
                            <field name="hourly_rate"/>
                            <field name="daily_rate"/>
                            <field name="monthly_rate"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Amenities">
                            <!-- Many2many field â€” rendered as tag list -->
                            <field name="amenity_ids" widget="many2many_tags"/>
                        </page>
                        <page string="Description">
                            <field name="description" nolabel="1"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_workspace_space_search" model="ir.ui.view">
        <field name="name">workspace.space.search</field>
        <field name="model">workspace.space</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="space_type_id"/>
                <field name="location_floor"/>
                <field name="location_zone"/>
                <filter string="Active"   name="active"   domain="[('is_active', '=', True)]"/>
                <filter string="Inactive" name="inactive" domain="[('is_active', '=', False)]"/>
                <group expand="0" string="Group By">
                    <filter string="Type"  name="group_type"  context="{'group_by': 'space_type_id'}"/>
                    <filter string="Floor" name="group_floor" context="{'group_by': 'location_floor'}"/>
                    <filter string="Zone"  name="group_zone"  context="{'group_by': 'location_zone'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_workspace_space" model="ir.actions.act_window">
        <field name="name">Spaces</field>
        <field name="res_model">workspace.space</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{}</field>
    </record>


    <!-- =====================================================
         WORKSPACE BOOKINGS
         - total_price is computed+stored (readonly in form)
         - status: pending / confirmed / cancelled / completed
         - booking_type: hourly / daily / monthly  (Selection)
         - created_date: readonly (default=now)
    ====================================================== -->

   <record id="view_workspace_booking_tree" model="ir.ui.view">
    <field name="name">workspace.booking.tree</field>
    <field name="model">workspace.booking</field>
    <field name="arch" type="xml">
        <tree decoration-success="status == 'confirmed'"
              decoration-warning="status == 'pending'"
              decoration-muted="status == 'cancelled'"
              decoration-info="status == 'completed'">
            <field name="space_id"/>
            <field name="customer_id"/>
            <field name="booking_type"/>
            <field name="duration_value" string="Duration"/>
            <field name="start_date"/>
            <field name="end_date"/>
            <field name="total_price"/>
            <field name="status" widget="badge"/>
        </tree>
    </field>
</record>

<record id="view_workspace_booking_form" model="ir.ui.view">
    <field name="name">workspace.booking.form</field>
    <field name="model">workspace.booking</field>
    <field name="arch" type="xml">
        <form>
            <header>
                <!-- Confirm button: visible only for existing records with pending status -->
                <button name="action_confirm" string="Confirm" type="object"
                        class="btn-primary"
                        invisible="not id or status != 'pending'"/>
                
                <!-- Cancel button: visible only for existing records with pending or confirmed status -->
                <button name="action_cancel" string="Cancel" type="object"
                        class="btn-secondary"
                        invisible="not id or status not in ('pending', 'confirmed')"/>
                
                <!-- Complete button: visible only for existing records with confirmed status -->
                <button name="action_complete" string="Mark as Completed" type="object"
                        class="btn-success"
                        invisible="not id or status != 'confirmed'"/>
                
                <field name="status" widget="statusbar"
                       statusbar_visible="pending,confirmed,completed"/>
            </header>
            <sheet>
                <group>
                    <group string="Booking Info">
                        <field name="space_id"/>
                        <field name="customer_id"/>
                        <field name="booking_type"/>
                    </group>
                    <group string="Schedule">
                        <field name="start_date"/>
                        <field name="duration_value" widget="float"/>
                        <field name="end_date" readonly="1"/>
                    </group>
                </group>
                <group>
                    <group string="Price">
                        <field name="total_price" readonly="1"/>
                        <field name="created_date" readonly="1"/>
                    </group>
                </group>
                <group string="Notes">
                    <field name="notes" nolabel="1"/>
                </group>
            </sheet>
        </form>
    </field>
</record>
    <record id="view_workspace_booking_search" model="ir.ui.view">
        <field name="name">workspace.booking.search</field>
        <field name="model">workspace.booking</field>
        <field name="arch" type="xml">
            <search>
                <field name="space_id"/>
                <field name="customer_id"/>
                <filter string="Pending"   name="pending"   domain="[('status', '=', 'pending')]"/>
                <filter string="Confirmed" name="confirmed" domain="[('status', '=', 'confirmed')]"/>
                <filter string="Completed" name="completed" domain="[('status', '=', 'completed')]"/>
                <filter string="Cancelled" name="cancelled" domain="[('status', '=', 'cancelled')]"/>
                <separator/>
                <filter string="Hourly"  name="hourly"  domain="[('booking_type', '=', 'hourly')]"/>
                <filter string="Daily"   name="daily"   domain="[('booking_type', '=', 'daily')]"/>
                <filter string="Monthly" name="monthly" domain="[('booking_type', '=', 'monthly')]"/>
                <group expand="0" string="Group By">
                    <filter string="Space"        name="group_space"    context="{'group_by': 'space_id'}"/>
                    <filter string="Customer"     name="group_customer" context="{'group_by': 'customer_id'}"/>
                    <filter string="Status"       name="group_status"   context="{'group_by': 'status'}"/>
                    <filter string="Booking Type" name="group_type"     context="{'group_by': 'booking_type'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_workspace_booking" model="ir.actions.act_window">
        <field name="name">Bookings</field>
        <field name="res_model">workspace.booking</field>
        <field name="view_mode">tree,form</field>
    </record>

</odoo>